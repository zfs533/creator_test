{"version":3,"sources":["assets/scene/scrollview/scrollview_h.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class ScrollView_h extends cc.Component {\n\n    @property(cc.Node)\n    item_h: cc.Node = undefined;\n\n    @property(cc.Node)\n    content_hor: cc.Node = undefined;\n\n    @property(cc.ScrollView)\n    scrollview_hor: cc.ScrollView = undefined;\n\n\n    private viewWidth: number = 0;\n    private contentOringinX: number = 0;\n    private count: number = 0;\n    private childNum_hor: number = 8;\n    private itemArr_hor: cc.Node[] = [];\n    private posArr_hor: cc.Vec2[] = [];\n\n    @property()\n    private length_hor: number = 100;\n    async start() {\n        await this.init();\n        this.setData_hor();\n\n    }\n\n    async init() {\n        return new Promise(async resolve => {\n            this.item_h.active = false;\n            this.viewWidth = this.content_hor.width;\n            this.contentOringinX = Math.floor(this.content_hor.x);\n            this.scrollview_hor.node.on(\"scrolling\", this.handleScroling_hor, this);\n            await this.initList_hor();\n            resolve();\n        });\n    }\n\n    async initList_hor() {\n        return new Promise(async resolve => {\n            if (this.content_hor.childrenCount < 1) {\n                let width = 0;\n                for (let i = 0; i < this.childNum_hor; i++) {\n                    let item = cc.instantiate(this.item_h);\n                    item.active = true;\n                    item.getChildByName(\"lb\").getComponent(cc.Label).string = i + \"\";\n                    width += item.width;\n                    let v2 = new cc.Vec2(item.width / 2 + item.width * i, 0);\n                    item.setPosition(v2);\n                    this.content_hor.addChild(item);\n                    this.itemArr_hor.push(item);\n                    this.resetContentSize_hor(width);\n                }\n            }\n\n            resolve();\n        });\n    }\n\n    resetContentSize_hor(width: number) {\n        if (width > this.viewWidth) {\n            this.content_hor.setContentSize(width, this.content_hor.height);\n        }\n    }\n\n    setData_hor() {\n        let width = 0;\n        let len: number = this.length_hor > 20 ? 20 : this.length_hor;\n        for (let i = 0; i < len; i++) {\n            width += this.item_h.width;\n            let v2 = new cc.Vec2(this.item_h.width / 2 + this.item_h.width * i, 0);\n            this.posArr_hor.push(v2);\n        }\n        this.resetContentSize_hor(width);\n        this.scheduleOnce(() => {\n            for (let i = len; i < this.length_hor; i++) {\n                width += this.item_h.width;\n                let v2 = new cc.Vec2(this.item_h.width / 2 + this.item_h.width * i, 0);\n                this.posArr_hor.push(v2);\n            }\n            this.resetContentSize_hor(width);\n        }, 1);\n    }\n\n    handleScroling_hor() {\n        if (this.itemArr_hor.length * this.item_h.width < this.viewWidth) { return; }\n        let contentX = Math.floor(this.content_hor.x);\n        let distance = this.contentOringinX - contentX;\n        let count = Math.floor(distance / this.item_h.width);\n        if (count < 0 || count + this.itemArr_hor.length > this.posArr_hor.length || count == this.count) {\n            return;\n        }\n        this.count = count;\n        for (let i = count; i < count + this.itemArr_hor.length; i++) {\n            let item = this.itemArr_hor[i - count];\n            item.getChildByName(\"lb\").getComponent(cc.Label).string = i + \"\";\n            item.x = this.posArr_hor[i].x;\n        }\n    }\n}\n"]}